(*
This file is generated by Cogent

*)

theory Random_seed_MonoProof
imports "Cogent.Mono_Tac"
"Random_seed_TypeProof"
"Random_seed_Deep_Normal"
begin

definition
  rename__assocs :: "(( string \<times>  Cogent.type list) \<times>  string) list"
where
  "rename__assocs \<equiv> [((''main'', Nil), ''main''), ((''rand_with_seed'', Nil), ''rand_with_seed'')]"

local_setup \<open>
gen_mono_rename Cogent_functions @{thm rename__assocs_def} "rename"
\<close>


context value_sem begin

ML \<open>
local
  (* Get mono-to-poly mapping from the assoc-list for @{term rename} *)
  val rename_inverse =
    Thm.prop_of @{thm rename__assocs_def}
    |> Logic.dest_equals |> snd
    |> HOLogic.dest_list
    |> map (HOLogic.dest_prod #> apfst HOLogic.dest_prod)
    |> map (fn ((poly_f, typs), mono_f) => (HOLogic.dest_string mono_f, (HOLogic.dest_string poly_f, typs)))
    |> Symtab.make
  val poly_thy = "Random_seed_Deep_Normal"
  val mono_thy = "Random_seed_TypeProof"
  val abbrev_defs = maps (fn thy => Proof_Context.get_thms @{context} (thy ^ ".abbreviated_type_defs"))
                      [poly_thy, mono_thy]
  val rename_simps = Proof_Context.get_thms @{context} "rename_simps"
                     handle ERROR _ => []
in
val monoexpr_thms =
  fold (fn f => fn callees =>
          gen_monoexpr_thm poly_thy mono_thy @{term rename} rename_inverse callees f
                           (abbrev_defs @ rename_simps) @{context}
          :: callees)
       (* NB: here "Cogent_functions" must refer to the list of *monomorphic* Cogent functions.
        *     Obtain it by importing the TypeProof theory before the Deep_Normal theory.
        * FIXME: we should assign the poly and mono function lists to distinct names. *)
       Cogent_functions []
  |> (fn thms => Symtab.make (Cogent_functions ~~ rev thms))
end
\<close>


end

end
